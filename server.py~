import serial
from urllib2 import urlopen
from simplejson import loads
import fbconsole
import serial
import time
from api import *

#content = loads(urlopen('http://graph.facebook.com/jpwright').read())
#print content

fbconsole.AUTH_SCOPE = ['read_stream']
fbconsole.authenticate()
print "authenticated"

ser = serial.Serial('/dev/pts/5', 19200, timeout=1)
print "communicating on "+ser.portstr

print "listening"

while(1):
    #ser.write("hello")
    #print "hello"
    #time.sleep(0.2)
    line = ser.readline()
    if line.startswith("h"):
        print "hello"
        ser.write("hello")
    if line.startswith("f"):
        newsfeed = fbconsole.get('/me/home')
        newsfeedstart = 0
        displaying = "feed"
        printnews(newsfeed, newsfeedstart, ser)
    if line.startswith("n"):
        newsfeedstart += 7
        printnews(newsfeed, newsfeedstart, ser)

